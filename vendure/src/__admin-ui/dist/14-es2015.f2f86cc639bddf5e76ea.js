(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{tB2i:function(c,e,t){"use strict";t.r(e),t.d(e,"HealthCheckComponent",(function(){return N})),t.d(e,"JobListComponent",(function(){return U})),t.d(e,"JobStateLabelComponent",(function(){return x})),t.d(e,"SystemModule",(function(){return q})),t.d(e,"systemRoutes",(function(){return F})),t.d(e,"\u02750",(function(){return Y})),t.d(e,"\u02751",(function(){return T}));var n=t("EM62"),s=t("ixhn"),r=t("nIj0"),a=t("sEIs"),i=t("8lHc"),o=t("kuMc"),l=t("xVbo"),d=t("YtkY"),u=t("OxKu"),h=t("2kYt"),b=t("Kej3"),m=t("s2Ay"),p=t("jY47");function g(c,e){1&c&&(n.gc(0),n.Wc(1),n.sc(2,"translate"),n.fc()),2&c&&(n.Rb(1),n.Yc(" ",n.tc(2,1,"system.health-all-systems-up")," "))}function f(c,e){1&c&&(n.Wc(0),n.sc(1,"translate")),2&c&&n.Yc(" ",n.tc(1,1,"system.health-error")," ")}const y=function(c,e){return{"is-success":c,"is-danger":e}};function v(c,e){if(1&c&&(n.ic(0,"div",7),n.ic(1,"div",8),n.dc(2,"clr-icon",9),n.hc(),n.ic(3,"div",10),n.Uc(4,g,3,3,"ng-container",11),n.Uc(5,f,2,3,"ng-template",null,12,n.Vc),n.ic(7,"div",13),n.Wc(8),n.sc(9,"translate"),n.sc(10,"localeDate"),n.sc(11,"async"),n.hc(),n.hc(),n.hc()),2&c){const c=e.ngIf,t=n.Ic(6),s=n.rc();n.Rb(2),n.yc("ngClass",n.Dc(13,y,"ok"===c,"ok"!==c)),n.Sb("shape","ok"===c?"check-circle":"exclamation-circle"),n.Rb(2),n.yc("ngIf","ok"===c)("ngIfElse",t),n.Rb(4),n.Zc(" ",n.tc(9,6,"system.health-last-checked"),": ",n.uc(10,8,n.tc(11,11,s.healthCheckService.lastCheck$),"mediumTime")," ")}}function R(c,e){1&c&&(n.gc(0),n.dc(1,"clr-icon",17),n.Wc(2),n.sc(3,"translate"),n.fc()),2&c&&(n.Rb(2),n.Yc(" ",n.tc(3,1,"system.health-status-up")," "))}function j(c,e){1&c&&(n.dc(0,"clr-icon",18),n.Wc(1),n.sc(2,"translate")),2&c&&(n.Rb(1),n.Yc(" ",n.tc(2,1,"system.health-status-down")," "))}function k(c,e){if(1&c&&(n.ic(0,"tr"),n.ic(1,"td",14),n.Wc(2),n.hc(),n.ic(3,"td",14),n.ic(4,"vdr-chip",15),n.Uc(5,R,4,3,"ng-container",11),n.Uc(6,j,3,3,"ng-template",null,16,n.Vc),n.hc(),n.hc(),n.ic(8,"td",14),n.Wc(9),n.hc(),n.hc()),2&c){const c=e.$implicit,t=n.Ic(7);n.Rb(2),n.Xc(c.key),n.Rb(2),n.yc("colorType","up"===c.result.status?"success":"error"),n.Rb(1),n.yc("ngIf","up"===c.result.status)("ngIfElse",t),n.Rb(4),n.Xc(c.result.message)}}function I(c,e){1&c&&(n.gc(0),n.Wc(1),n.sc(2,"translate"),n.fc()),2&c&&(n.Rb(1),n.Yc(" ",n.tc(2,1,"system.all-job-queues")," "))}function C(c,e){if(1&c&&(n.ic(0,"vdr-chip",8),n.Wc(1),n.hc()),2&c){const c=n.rc().item;n.yc("colorFrom",c.name),n.Rb(1),n.Xc(c.name)}}function w(c,e){if(1&c&&(n.Uc(0,I,3,3,"ng-container",6),n.Uc(1,C,2,2,"ng-template",null,7,n.Vc)),2&c){const c=e.item,t=n.Ic(2);n.yc("ngIf","all"===c.name)("ngIfElse",t)}}function W(c,e){if(1&c&&(n.ic(0,"vdr-dropdown"),n.ic(1,"button",14),n.sc(2,"translate"),n.dc(3,"clr-icon",15),n.hc(),n.ic(4,"vdr-dropdown-menu"),n.ic(5,"div",16),n.dc(6,"vdr-object-tree",17),n.hc(),n.hc(),n.hc()),2&c){const c=n.rc().item;n.Rb(1),n.yc("title",n.tc(2,2,"system.job-data")),n.Rb(5),n.yc("value",c.data)}}function P(c,e){if(1&c&&(n.ic(0,"vdr-dropdown"),n.ic(1,"button",18),n.dc(2,"clr-icon",15),n.Wc(3),n.sc(4,"translate"),n.hc(),n.ic(5,"vdr-dropdown-menu"),n.ic(6,"div",16),n.dc(7,"vdr-object-tree",17),n.hc(),n.hc(),n.hc()),2&c){const c=n.rc().item;n.Rb(3),n.Yc(" ",n.tc(4,2,"system.job-result")," "),n.Rb(4),n.yc("value",c.result)}}function S(c,e){if(1&c&&(n.ic(0,"vdr-dropdown"),n.ic(1,"button",18),n.dc(2,"clr-icon",19),n.Wc(3),n.sc(4,"translate"),n.hc(),n.ic(5,"vdr-dropdown-menu"),n.ic(6,"div",16),n.Wc(7),n.hc(),n.hc(),n.hc()),2&c){const c=n.rc().item;n.Rb(3),n.Yc(" ",n.tc(4,2,"system.job-error")," "),n.Rb(4),n.Yc(" ",c.error," ")}}function O(c,e){if(1&c){const c=n.jc();n.ic(0,"vdr-dropdown"),n.ic(1,"button",20),n.dc(2,"clr-icon",21),n.hc(),n.ic(3,"vdr-dropdown-menu",22),n.ic(4,"button",23),n.pc("click",(function(){n.Lc(c);const e=n.rc().item;return n.rc().cancelJob(e.id)})),n.sc(5,"hasPermission"),n.dc(6,"clr-icon",24),n.Wc(7),n.sc(8,"translate"),n.hc(),n.hc(),n.hc()}2&c&&(n.Rb(4),n.yc("disabled",!n.tc(5,2,"DeleteSettings")),n.Rb(3),n.Yc(" ",n.tc(8,4,"common.cancel")," "))}function E(c,e){if(1&c&&(n.ic(0,"td",9),n.dc(1,"vdr-entity-info",10),n.hc(),n.ic(2,"td",9),n.Uc(3,W,7,4,"vdr-dropdown",11),n.ic(4,"vdr-chip",8),n.Wc(5),n.hc(),n.hc(),n.ic(6,"td",9),n.Wc(7),n.sc(8,"timeAgo"),n.hc(),n.ic(9,"td",9),n.dc(10,"vdr-job-state-label",12),n.hc(),n.ic(11,"td",9),n.Wc(12),n.sc(13,"duration"),n.hc(),n.ic(14,"td",9),n.Uc(15,P,8,4,"vdr-dropdown",11),n.Uc(16,S,8,4,"vdr-dropdown",11),n.hc(),n.ic(17,"td",13),n.Uc(18,O,9,6,"vdr-dropdown",11),n.hc()),2&c){const c=e.item,t=n.rc();n.Rb(1),n.yc("entity",c),n.Rb(2),n.yc("ngIf",c.data),n.Rb(1),n.yc("colorFrom",c.queueName),n.Rb(1),n.Xc(c.queueName),n.Rb(2),n.Xc(n.tc(8,10,c.createdAt)),n.Rb(3),n.yc("job",c),n.Rb(2),n.Xc(n.tc(13,12,c.duration)),n.Rb(3),n.yc("ngIf",t.hasResult(c)),n.Rb(1),n.yc("ngIf",c.error),n.Rb(2),n.yc("ngIf",!c.isSettled&&"FAILED"!==c.state)}}function D(c,e){if(1&c&&(n.ic(0,"span",2),n.Wc(1),n.sc(2,"percent"),n.hc()),2&c){const c=n.rc();n.Rb(1),n.Yc(" ",n.tc(2,1,c.job.progress/100)," ")}}class N{constructor(c){this.healthCheckService=c}}N.\u0275fac=function(c){return new(c||N)(n.cc(s.kb))},N.\u0275cmp=n.Wb({type:N,selectors:[["vdr-health-check"]],decls:25,vars:18,consts:[["class","system-status-header",4,"ngIf"],["locationId","system-status"],[1,"btn","btn-secondary",3,"click"],["shape","refresh"],[1,"table"],[1,"left"],[4,"ngFor","ngForOf"],[1,"system-status-header"],[1,"status-icon"],["size","48",3,"ngClass"],[1,"status-detail"],[4,"ngIf","ngIfElse"],["error",""],[1,"last-checked"],[1,"align-middle","left"],[3,"colorType"],["down",""],["shape","check-circle"],["shape","exclamation-circle"]],template:function(c,e){1&c&&(n.ic(0,"vdr-action-bar"),n.ic(1,"vdr-ab-left"),n.Uc(2,v,12,16,"div",0),n.sc(3,"async"),n.hc(),n.ic(4,"vdr-ab-right"),n.dc(5,"vdr-action-bar-items",1),n.ic(6,"button",2),n.pc("click",(function(){return e.healthCheckService.refresh()})),n.dc(7,"clr-icon",3),n.Wc(8),n.sc(9,"translate"),n.hc(),n.hc(),n.hc(),n.ic(10,"table",4),n.ic(11,"thead"),n.ic(12,"tr"),n.ic(13,"th",5),n.Wc(14),n.sc(15,"translate"),n.hc(),n.ic(16,"th",5),n.Wc(17),n.sc(18,"translate"),n.hc(),n.ic(19,"th",5),n.Wc(20),n.sc(21,"translate"),n.hc(),n.hc(),n.hc(),n.ic(22,"tbody"),n.Uc(23,k,10,5,"tr",6),n.sc(24,"async"),n.hc(),n.hc()),2&c&&(n.Rb(2),n.yc("ngIf",n.tc(3,6,e.healthCheckService.status$)),n.Rb(6),n.Yc(" ",n.tc(9,8,"system.health-refresh")," "),n.Rb(6),n.Yc(" ",n.tc(15,10,"common.name")," "),n.Rb(3),n.Yc(" ",n.tc(18,12,"system.health-status")," "),n.Rb(3),n.Yc(" ",n.tc(21,14,"system.health-message")," "),n.Rb(3),n.yc("ngForOf",n.tc(24,16,e.healthCheckService.details$)))},directives:[s.c,s.e,h.o,s.f,s.d,b.o,h.n,h.m,s.C],pipes:[h.b,m.d,s.Bb],styles:[".system-status-header[_ngcontent-%COMP%]{align-items:flex-start;display:flex;justify-content:space-between}.system-status-header[_ngcontent-%COMP%]   .status-detail[_ngcontent-%COMP%]{font-weight:700}.system-status-header[_ngcontent-%COMP%]   .last-checked[_ngcontent-%COMP%]{color:var(--color-grey-500);font-weight:400}"],changeDetection:0}),N.ctorParameters=()=>[{type:s.kb}];class U extends s.x{constructor(c,e,t,n,a){super(n,a),this.dataService=c,this.modalService=e,this.notificationService=t,this.liveUpdate=new r.f(!0),this.hideSettled=new r.f(!0),this.queueFilter=new r.f("all"),super.setQueryFn((...c)=>this.dataService.settings.getAllJobs(...c),c=>c.jobs,(c,e)=>{const t="all"===this.queueFilter.value?null:{queueName:{eq:this.queueFilter.value}},n=this.hideSettled.value;return{options:{skip:c,take:e,filter:Object.assign(Object.assign({},t),n?{isSettled:{eq:!1}}:{}),sort:{createdAt:s.Ob.DESC}}}})}ngOnInit(){super.ngOnInit(),Object(i.a)(5e3,2e3).pipe(Object(o.a)(this.destroy$),Object(l.a)(()=>this.liveUpdate.value)).subscribe(()=>{this.refresh()}),this.queues$=this.dataService.settings.getJobQueues().mapStream(c=>c.jobQueues).pipe(Object(d.a)(c=>[{name:"all",running:!0},...c]))}hasResult(c){const e=c.result;return null!=e&&("object"!=typeof e||Object.keys(e).length>0)}cancelJob(c){this.dataService.settings.cancelJob(c).subscribe(()=>this.refresh())}}U.\u0275fac=function(c){return new(c||U)(n.cc(s.L),n.cc(s.Db),n.cc(s.Eb),n.cc(a.e),n.cc(a.a))},U.\u0275cmp=n.Wb({type:U,selectors:[["vdr-job-list"]],features:[n.Ob],decls:41,vars:45,consts:[["type","checkbox","clrCheckbox","","name","live-update",3,"formControl"],["type","checkbox","clrCheckbox","","name","hide-settled",3,"formControl","change"],["bindValue","name",3,"addTag","items","hideSelected","multiple","markFirst","clearable","searchable","formControl","change"],["ng-label-tmp","","ng-option-tmp",""],["locationId","job-list"],[3,"items","itemsPerPage","totalItems","currentPage","pageChange","itemsPerPageChange"],[4,"ngIf","ngIfElse"],["others",""],[3,"colorFrom"],[1,"left","align-middle"],[3,"entity"],[4,"ngIf"],[3,"job"],[1,"right","align-middle"],["vdrDropdownTrigger","",1,"btn","btn-link","btn-icon",3,"title"],["shape","details"],[1,"result-detail"],[3,"value"],["vdrDropdownTrigger","",1,"btn","btn-link","btn-sm","details-button"],["shape","exclamation-circle"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"disabled","click"],["shape","ban",1,"is-danger"]],template:function(c,e){1&c&&(n.ic(0,"vdr-action-bar"),n.ic(1,"vdr-ab-left"),n.ic(2,"clr-checkbox-container"),n.ic(3,"clr-checkbox-wrapper"),n.dc(4,"input",0),n.ic(5,"label"),n.Wc(6),n.sc(7,"translate"),n.hc(),n.hc(),n.ic(8,"clr-checkbox-wrapper"),n.ic(9,"input",1),n.pc("change",(function(){return e.refresh()})),n.hc(),n.ic(10,"label"),n.Wc(11),n.sc(12,"translate"),n.hc(),n.hc(),n.hc(),n.hc(),n.ic(13,"vdr-ab-right"),n.ic(14,"ng-select",2),n.pc("change",(function(){return e.refresh()})),n.sc(15,"async"),n.Uc(16,w,3,2,"ng-template",3),n.hc(),n.dc(17,"vdr-action-bar-items",4),n.hc(),n.hc(),n.ic(18,"vdr-data-table",5),n.pc("pageChange",(function(c){return e.setPageNumber(c)}))("itemsPerPageChange",(function(c){return e.setItemsPerPage(c)})),n.sc(19,"async"),n.sc(20,"async"),n.sc(21,"async"),n.sc(22,"async"),n.dc(23,"vdr-dt-column"),n.ic(24,"vdr-dt-column"),n.Wc(25),n.sc(26,"translate"),n.hc(),n.ic(27,"vdr-dt-column"),n.Wc(28),n.sc(29,"translate"),n.hc(),n.ic(30,"vdr-dt-column"),n.Wc(31),n.sc(32,"translate"),n.hc(),n.ic(33,"vdr-dt-column"),n.Wc(34),n.sc(35,"translate"),n.hc(),n.ic(36,"vdr-dt-column"),n.Wc(37),n.sc(38,"translate"),n.hc(),n.dc(39,"vdr-dt-column"),n.Uc(40,E,19,14,"ng-template"),n.hc()),2&c&&(n.Rb(4),n.yc("formControl",e.liveUpdate),n.Rb(2),n.Xc(n.tc(7,21,"common.live-update")),n.Rb(3),n.yc("formControl",e.hideSettled),n.Rb(2),n.Xc(n.tc(12,23,"system.hide-settled-jobs")),n.Rb(3),n.yc("addTag",!1)("items",n.tc(15,25,e.queues$))("hideSelected",!0)("multiple",!1)("markFirst",!1)("clearable",!1)("searchable",!1)("formControl",e.queueFilter),n.Rb(4),n.yc("items",n.tc(19,27,e.items$))("itemsPerPage",n.tc(20,29,e.itemsPerPage$))("totalItems",n.tc(21,31,e.totalItems$))("currentPage",n.tc(22,33,e.currentPage$)),n.Rb(7),n.Xc(n.tc(26,35,"system.job-queue-name")),n.Rb(3),n.Xc(n.tc(29,37,"common.created-at")),n.Rb(3),n.Xc(n.tc(32,39,"system.job-state")),n.Rb(3),n.Xc(n.tc(35,41,"system.job-duration")),n.Rb(3),n.Xc(n.tc(38,43,"system.job-result")))},directives:function(){return[s.c,s.e,b.j,b.k,s.fb,r.a,b.i,r.p,r.g,b.u,s.f,p.a,p.e,p.d,s.d,s.N,s.M,h.o,s.C,s.bb,x,s.T,s.W,b.o,s.V,s.Fb,s.U]},pipes:function(){return[m.d,h.b,s.Tb,s.X,s.jb]},styles:[".result-detail[_ngcontent-%COMP%]{margin:0 12px}"],changeDetection:0}),U.ctorParameters=()=>[{type:s.L},{type:s.Db},{type:s.Eb},{type:a.e},{type:a.a}];class x{get iconShape(){switch(this.job.state){case s.ub.COMPLETED:return"check-circle";case s.ub.FAILED:return"exclamation-circle";case s.ub.CANCELLED:return"ban";case s.ub.PENDING:case s.ub.RETRYING:return"hourglass";case s.ub.RUNNING:return"sync"}}get colorType(){switch(this.job.state){case s.ub.COMPLETED:return"success";case s.ub.FAILED:case s.ub.CANCELLED:return"error";case s.ub.PENDING:case s.ub.RETRYING:return"";case s.ub.RUNNING:return"warning"}}}x.\u0275fac=function(c){return new(c||x)},x.\u0275cmp=n.Wb({type:x,selectors:[["vdr-job-state-label"]],inputs:{job:"job"},decls:5,vars:6,consts:[[3,"colorType"],["class","progress",4,"ngIf"],[1,"progress"]],template:function(c,e){1&c&&(n.ic(0,"vdr-chip",0),n.dc(1,"clr-icon"),n.Wc(2),n.sc(3,"titlecase"),n.Uc(4,D,3,3,"span",1),n.hc()),2&c&&(n.yc("colorType",e.colorType),n.Rb(1),n.Sb("shape",e.iconShape),n.Rb(1),n.Yc(" ",n.tc(3,4,e.job.state)," "),n.Rb(2),n.yc("ngIf","RUNNING"===e.job.state))},directives:[s.C,b.o,h.o],pipes:[h.y,h.v],styles:[".progress[_ngcontent-%COMP%]{margin-left:3px}clr-icon[_ngcontent-%COMP%]{min-width:12px}"],changeDetection:0}),x.propDecorators={job:[{type:n.D}]};const Y={breadcrumb:Object(u.a)("breadcrumb.job-queue")},T={breadcrumb:Object(u.a)("breadcrumb.system-status")},F=[{path:"jobs",component:U,data:Y},{path:"system-status",component:N,data:T}];class q{}q.\u0275mod=n.ac({type:q}),q.\u0275inj=n.Zb({factory:function(c){return new(c||q)},imports:[[s.Nb,a.i.forChild(F)]]})}}]);
//# sourceMappingURL=14-es2015.f2f86cc639bddf5e76ea.js.map